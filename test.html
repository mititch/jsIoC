<!DOCTYPE html>
<html>
<body>

<h1>jsIoC test</h1>
<p>Open the browser console to see results</p>

</body>

<script src="jsioc.js"></script>
<script src="ctors.js"></script>
<script type="text/javascript">

    window.onload = function() {

        var trigger = false;

        function FakeCtorB (cont) {
            this.i = 0; 
            trigger = true;
            this.doB = function() {
                this.i++;
            };
        };
        FakeCtorB.interface = "interfaceB";
        
        var testCont = new Container();
        var testConfig = {
            'interfaceB': testCont.Singleton(FakeCtorB)
        };
        testCont.Config(testConfig);

        
        var objA1 = new CtorA(testCont),
            objA2 = new CtorA(testCont);
            objA3 = new CtorA(testCont);
        
        objA1.doA();
        
        console.log('Expect: call doA() make call to doB() -> ' + trigger);

        objA2.doA();
        objA3.doA();

        console.log('Expect: interfaceB registered as singleton -> ' + (objA1.objB.i == 3));
        
    };
    
</script>

</html>
